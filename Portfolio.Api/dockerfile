# ðŸ“„ Dockerfile (En la carpeta Portfolio.Api/)

# ETAPA 1: ConstrucciÃ³n (Build)
FROM mcr.microsoft.com/dotnet/sdk:8.0 AS build
# El directorio de trabajo temporal es /src
WORKDIR /src

# ðŸ’¥ CORRECCIÃ“N DE RUTAS ðŸ’¥

# Copiar el archivo de soluciÃ³n (.sln)
COPY ../PortfolioSolution.sln . 

# Copiar el .csproj del proyecto API
COPY Portfolio.Api.csproj Portfolio.Api/

# Copiar el .csproj del proyecto SHARED
COPY ../Portfolio.Shared/Portfolio.Shared.csproj Portfolio.Shared/

# 2. Restaurar dependencias 
RUN dotnet restore

# 3. Copiar el resto de archivos y publicar
COPY . .
WORKDIR "/src/Portfolio.Api"
RUN dotnet publish "Portfolio.Api.csproj" -c Release -o /app/publish /p:UseAppHost=false

# ETAPA 2: EjecuciÃ³n (Runtime)
FROM mcr.microsoft.com/dotnet/aspnet:8.0 AS final
WORKDIR /app
COPY --from=build /app/publish .
EXPOSE 8080 
ENTRYPOINT ["dotnet", "Portfolio.Api.dll"]